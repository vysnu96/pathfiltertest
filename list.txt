Aldrin
Athiselvam
Jose Lopez
Monica V
Ruth M
Sahaya Shiny
Sajeena
Saleen
Siva Ganesh
Sivaprasanth N
Anumanth E
Jasper Paul
Lekshmi
Loyds
Mahiban
Manosanthi S
Siva M
Vibin Dhas
Vinoth V
Godson
Nino
Gershon

$collection = Get-Content C:\Users\vishnuvardhan.j\Desktop\list.txt

foreach ($item in $collection)
{
    New-SelfSignedCertificate `
    -Type Custom `
    -DnsName P2SChildCert `
    -KeySpec Signature `
    -Subject "CN=$item" `
    -KeyExportPolicy Exportable `
    -HashAlgorithm sha256 `
    -KeyLength 2048 `
    -CertStoreLocation "Cert:\CurrentUser\My" `
    -Signer $cert `
    -TextExtension @("2.5.29.37={text}1.3.6.1.5.5.7.3.2")

    $ClientCert = (Get-ChildItem `
    -Path "Cert:\CurrentUser\My\"`
    | Where-Object `
    -Property subject `
    -Match $item)
    

Get-ChildItem -Path Cert:\CurrentUser\My\$item | Export-PfxCertificate -FilePath C:\Users\connectbase\Desktop\New\$item.pfx -Password connectbase
}